<Page
    x:Class="AWMKit.Pages.DetectPage"
    x:Name="RootPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:AWMKit.Models"
    mc:Ignorable="d">
    <Page.Resources>
        <Style x:Key="DetectMainCardBorderStyle" TargetType="Border" BasedOn="{StaticResource CardBorderStyle}">
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="DetectHeaderBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="{ThemeResource ControlFillColorSecondaryBrush}"/>
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Margin" Value="2,2,2,0"/>
        </Style>
        <Style x:Key="DetectInfoCellBorderStyle" TargetType="Border" BasedOn="{StaticResource ListItemBorderStyle}">
            <Setter Property="Background" Value="{ThemeResource ControlFillColorSecondaryBrush}"/>
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,10"/>
        </Style>
        <Style x:Key="DetectMatrixCellBorderStyle" TargetType="Border" BasedOn="{StaticResource DetectInfoCellBorderStyle}">
            <Setter Property="Padding" Value="12,6"/>
        </Style>
    </Page.Resources>

    <Grid Padding="24" RowSpacing="12" ColumnSpacing="12" Background="{ThemeResource PageBackdropBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource DetectMainCardBorderStyle}" Padding="18">
            <Grid RowSpacing="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0"
                        Background="{ThemeResource ControlFillColorSecondaryBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12"
                        Margin="2,2,2,0">
                    <StackPanel Spacing="6">
                        <TextBlock Text="{x:Bind ViewModel.InputSectionTitle, Mode=OneWay}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Text="{x:Bind ViewModel.InputSourceText, Mode=OneWay}"
                                   TextWrapping="Wrap"
                                   MaxLines="2"
                                   TextTrimming="CharacterEllipsis"/>
                    </StackPanel>
                </Border>

                <InfoBar Grid.Row="1"
                         IsClosable="False"
                         Severity="Warning"
                         Visibility="{x:Bind AppState.KeyAvailable, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"
                         Message="{x:Bind ViewModel.MissingKeyMessage, Mode=OneWay}">
                    <InfoBar.ActionButton>
                        <Button Content="{x:Bind ViewModel.GoToKeyPageText, Mode=OneWay}" Click="GoToKeyPageButton_Click"/>
                    </InfoBar.ActionButton>
                </InfoBar>

                <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center" Margin="0,2,0,0">
                    <ComboBox Width="170"
                              ItemsSource="{x:Bind ViewModel.ChannelLayoutOptions, Mode=OneWay}"
                              SelectedItem="{x:Bind ViewModel.SelectedChannelLayout, Mode=TwoWay}"
                              DisplayMemberPath="DisplayText"
                              PlaceholderText="{x:Bind ViewModel.LayoutLabel, Mode=OneWay}"
                              AutomationProperties.Name="{x:Bind ViewModel.LayoutLabel, Mode=OneWay}"
                              Visibility="Collapsed"/>
                    <Button Click="SelectInputSourceButton_Click"
                            Style="{StaticResource SecondaryButtonStyle}"
                            AutomationProperties.Name="{x:Bind ViewModel.SelectInputSourceAccessibility, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <SymbolIcon Symbol="OpenFile"
                                        Visibility="{x:Bind ViewModel.IsInputSelectSuccess, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                            <SymbolIcon Symbol="OpenFile"
                                        Foreground="{StaticResource SuccessBrush}"
                                        Visibility="{x:Bind ViewModel.IsInputSelectSuccess, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <TextBlock Text="{x:Bind ViewModel.SelectActionText, Mode=OneWay}"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{x:Bind ViewModel.DetectOrStopCommand}"
                            IsEnabled="{x:Bind ViewModel.CanDetectOrStop, Mode=OneWay}"
                            Style="{StaticResource PrimaryButtonStyle}"
                            AutomationProperties.Name="{x:Bind ViewModel.DetectActionAccessibility, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <SymbolIcon Symbol="Play"
                                        Visibility="{x:Bind ViewModel.ShowDetectDefaultPlayIcon, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <SymbolIcon Symbol="Play"
                                        Foreground="{StaticResource SuccessBrush}"
                                        Visibility="{x:Bind ViewModel.ShowDetectSuccessPlayIcon, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <SymbolIcon Symbol="Stop"
                                        Foreground="{StaticResource ErrorBrush}"
                                        Visibility="{x:Bind ViewModel.ShowDetectStopIcon, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <TextBlock Text="{x:Bind ViewModel.DetectButtonText, Mode=OneWay}"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{x:Bind ViewModel.ClearQueueCommand}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            AutomationProperties.Name="{x:Bind ViewModel.ClearQueueAccessibility, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <SymbolIcon Symbol="List"
                                        Visibility="{x:Bind ViewModel.IsClearQueueSuccess, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                            <SymbolIcon Symbol="List"
                                        Foreground="{StaticResource SuccessBrush}"
                                        Visibility="{x:Bind ViewModel.IsClearQueueSuccess, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <TextBlock Text="{x:Bind ViewModel.ClearActionText, Mode=OneWay}"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{x:Bind ViewModel.ClearLogsCommand}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            AutomationProperties.Name="{x:Bind ViewModel.ClearLogsAccessibility, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <SymbolIcon Symbol="Message"
                                        Visibility="{x:Bind ViewModel.IsClearLogsSuccess, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                            <SymbolIcon Symbol="Message"
                                        Foreground="{StaticResource SuccessBrush}"
                                        Visibility="{x:Bind ViewModel.IsClearLogsSuccess, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <TextBlock Text="{x:Bind ViewModel.ClearActionText, Mode=OneWay}"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <Border Grid.Row="3"
                        x:Name="DropZone"
                        AllowDrop="True"
                        DragOver="DropZone_DragOver"
                        Drop="DropZone_Drop"
                        BorderThickness="1"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        CornerRadius="12"
                        Padding="20"
                        Margin="2,0,2,2"
                        Background="{ThemeResource ControlFillColorSecondaryBrush}">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="6">
                        <FontIcon Glyph="&#xE8B8;" FontSize="26"/>
                        <TextBlock Text="{x:Bind ViewModel.DropZoneTitle, Mode=OneWay}" FontWeight="SemiBold" TextAlignment="Center"/>
                        <TextBlock Text="{x:Bind ViewModel.DropZoneSubtitle, Mode=OneWay}" Foreground="{ThemeResource TextFillColorSecondaryBrush}" TextAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource DetectMainCardBorderStyle}" Padding="18">
            <Grid RowSpacing="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Style="{StaticResource DetectHeaderBorderStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind ViewModel.DetectInfoTitle, Mode=OneWay}" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <TextBlock Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{x:Bind ViewModel.DetectCountText, Mode=OneWay}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Visibility="{x:Bind ViewModel.HasDetectCount, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    </Grid>
                </Border>

                <Border Grid.Row="1" Style="{StaticResource DetectInfoCellBorderStyle}" Margin="2,0,2,0">
                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="68"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind ViewModel.FileFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Column="1" Text="{x:Bind ViewModel.DisplayFile, Mode=OneWay}" TextTrimming="CharacterEllipsis"/>
                    </Grid>
                </Border>

                <Grid Grid.Row="2" ColumnSpacing="10" Margin="2,0,2,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.StatusFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayStatus, Mode=OneWay}" Foreground="{x:Bind ViewModel.StatusBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.MatchFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayMatchFound, Mode=OneWay}" Foreground="{x:Bind ViewModel.MatchFoundBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.PatternFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayPattern, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <Grid Grid.Row="3" ColumnSpacing="10" Margin="2,0,2,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.TagFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayTag, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.IdentityFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayIdentity, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.VersionFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayVersion, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <Grid Grid.Row="4" ColumnSpacing="10" Margin="2,0,2,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.TimeFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayDetectTime, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.KeySlotFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayKeySlot, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.BitErrorsFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayBitErrors, Mode=OneWay}" Foreground="{x:Bind ViewModel.BitErrorsBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <Grid Grid.Row="5" ColumnSpacing="10" Margin="2,0,2,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.DetectScoreFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayDetectScore, Mode=OneWay}" Foreground="{x:Bind ViewModel.DetectScoreBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.CloneCheckFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayCloneCheck, Mode=OneWay}" Foreground="{x:Bind ViewModel.CloneCheckBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource DetectMatrixCellBorderStyle}">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{x:Bind ViewModel.FingerprintScoreFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Text="{x:Bind ViewModel.DisplayFingerprintScore, Mode=OneWay}" Foreground="{x:Bind ViewModel.FingerprintScoreBrush, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <Border Grid.Row="6" Style="{StaticResource DetectInfoCellBorderStyle}" Margin="2,0,2,2">
                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="68"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind ViewModel.ErrorFieldLabel, Mode=OneWay}" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Column="1" Text="{x:Bind ViewModel.DisplayError, Mode=OneWay}" Foreground="{x:Bind ViewModel.ErrorBrush, Mode=OneWay}" TextTrimming="CharacterEllipsis"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource DetectMainCardBorderStyle}" Padding="18">
            <Grid RowSpacing="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Style="{StaticResource DetectHeaderBorderStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind ViewModel.QueueTitle, Mode=OneWay}" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <TextBlock Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{x:Bind ViewModel.QueueCountText, Mode=OneWay}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Visibility="{x:Bind ViewModel.HasQueueCount, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    </Grid>
                </Border>

                <Grid Grid.Row="1" ColumnSpacing="8" Margin="2,0,2,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <ProgressBar Grid.Column="0" Value="{x:Bind ViewModel.ProgressPercent, Mode=OneWay}" Maximum="100" Height="8"/>
                    <TextBlock Grid.Column="1" Text="{x:Bind ViewModel.ProgressPercentText, Mode=OneWay}" HorizontalAlignment="Right" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </Grid>

                <TextBlock Grid.Row="2"
                           Text="{x:Bind ViewModel.QueueEmptyText, Mode=OneWay}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           Margin="0,8,0,0"
                           Visibility="{x:Bind ViewModel.ShowQueueEmptyHint, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <ListView Grid.Row="2"
                          ItemsSource="{x:Bind ViewModel.SelectedFiles, Mode=OneWay}"
                          SelectionMode="None"
                          Margin="2,6,2,2"
                          Visibility="{x:Bind ViewModel.QueueCount, Mode=OneWay, Converter={StaticResource CountToVisibilityConverter}}">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <Border Style="{StaticResource ListItemBorderStyle}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{x:Bind}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                                    <Button Grid.Column="1"
                                            Content="&#xE711;"
                                            FontFamily="Segoe Fluent Icons"
                                            Click="RemoveQueueFileButton_Click"
                                            Tag="{x:Bind}"
                                            Background="Transparent"
                                            BorderThickness="0"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Border>

        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource DetectMainCardBorderStyle}" Padding="18">
            <Grid RowSpacing="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Style="{StaticResource DetectHeaderBorderStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind ViewModel.LogsTitle, Mode=OneWay}" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <TextBlock Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{x:Bind ViewModel.LogCountText, Mode=OneWay}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Visibility="{x:Bind ViewModel.HasLogs, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    </Grid>
                </Border>

                <TextBox Grid.Row="1"
                         PlaceholderText="{x:Bind ViewModel.LogSearchPlaceholder, Mode=OneWay}"
                         Text="{x:Bind ViewModel.LogSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         Margin="2,0,2,0"
                         Visibility="{x:Bind ViewModel.ShowSearchBox, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <TextBlock Grid.Row="2"
                           Text="{x:Bind ViewModel.NoFilteredLogsText, Mode=OneWay}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           Margin="0,8,0,0"
                           Visibility="{x:Bind ViewModel.HasFilteredLogs, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>

                <ListView Grid.Row="2"
                          ItemsSource="{x:Bind ViewModel.FilteredLogs, Mode=OneWay}"
                          SelectionMode="None"
                          Margin="2,6,2,2"
                          Visibility="{x:Bind ViewModel.HasFilteredLogs, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="models:LogEntry">
                            <Button Click="LogEntryButton_Click"
                                    Tag="{x:Bind}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Stretch"
                                    Padding="0">
                                <Border BorderBrush="{x:Bind CardBorderBrush}"
                                        BorderThickness="1"
                                        Background="{x:Bind CardBackgroundBrush}"
                                        CornerRadius="8"
                                        Padding="10"
                                        Margin="0,0,0,6">
                                    <Grid RowSpacing="6">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <Grid Grid.Row="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <FontIcon Glyph="{x:Bind IconGlyph}" Foreground="{x:Bind IconBrush}" Margin="0,0,8,0"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind Title}" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Grid.Column="2"
                                                       Text="{x:Bind Timestamp, Mode=OneWay, Converter={StaticResource DateTimeConverter}}"
                                                       FontSize="12"
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        </Grid>

                                        <TextBlock Grid.Row="1"
                                                   Text="{x:Bind Detail}"
                                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                   TextWrapping="WrapWholeWords"
                                                   MaxLines="2"
                                                   TextTrimming="CharacterEllipsis"/>
                                    </Grid>
                                </Border>
                            </Button>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Border>
    </Grid>
</Page>
